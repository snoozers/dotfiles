# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# tmux 設定ファイル
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# ─── 基本設定 ───────────────────────────────────────────────────

# 256色とTrue Color対応
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# プレフィックスキー（デフォルト: Ctrl-b）
# 必要に応じて Ctrl-a に変更可能
# set -g prefix C-a
# unbind C-b
# bind C-a send-prefix

# エスケープキーの遅延を解消（Vim/Neovim使用時に重要）
set -sg escape-time 0

# スクロールバックバッファの上限（長時間のClaude Codeセッション向け）
set -g history-limit 50000

# ウィンドウとペインの番号を1から開始（0は押しにくいため）
set -g base-index 1
setw -g pane-base-index 1

# ウィンドウを閉じた時に番号を詰める
set -g renumber-windows on

# ─── マウス操作 ──────────────────────────────────────────────────

# マウス操作を有効化（ペイン選択・リサイズ・スクロール）
set -g mouse on

# ─── ステータスバー ──────────────────────────────────────────────

# ステータスバーを上部に表示
set -g status-position top

# ステータスバーの更新間隔（秒）
set -g status-interval 5

# ─── ペイン操作の改善 ────────────────────────────────────────────

# ペイン分割時にカレントディレクトリを引き継ぐ
bind '"' split-window -v -c "#{pane_current_path}"
bind '%' split-window -h -c "#{pane_current_path}"

# 新しいウィンドウ作成時もカレントディレクトリを引き継ぐ
bind c new-window -c "#{pane_current_path}"

# ─── iTerm2 ネイティブ統合 ───────────────────────────────────────
# tmux -CC で起動すると、iTerm2のネイティブタブ/ウィンドウとして動作する
# 以下の設定で統合モードの動作を改善する

# iTerm2統合モードでのウィンドウサイズ調整を許可
setw -g aggressive-resize off

# ─── セッション管理 ──────────────────────────────────────────────

# セッションが破棄された時に他のセッションに自動切り替え
set -g detach-on-destroy off
