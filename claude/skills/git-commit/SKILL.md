
---
name: git-commit
description: stagingされたファイルのgitコミットを作成
disable-model-invocation: true
allowed-tools: Bash(git status:*), Bash(git diff:*), Bash(git commit:*), Bash(git log:*), AskUserQuestion
---

## あなたのタスク

ステージングされた変更に基づいて、適切なコミットメッセージを作成し、gitコミットを実行する。

## 手順

### 1. 現状を把握する

以下のコマンドを並列で実行し、変更の全体像を把握する。

- `git status` — ステージング済み・未ステージの変更を確認
- `git diff --cached` — ステージング済みの差分を確認
- `git diff --cached --stat` — 変更ファイルの一覧と変更量を確認
- `git log --oneline -5` — 直近のコミットメッセージのスタイルを確認

### 2. 変更内容を分析する

差分を読み、以下を整理する。

- **何を変更したか** — 変更の事実（ファイル追加、関数修正、設定変更など）
- **なぜ変更したか** — 変更の動機・目的（バグ修正、機能追加、リファクタリングなど）
- **影響範囲** — 変更が及ぼす範囲（特定機能、全体の挙動など）

### 3. ユーザーに変更の意図を確認する

AskUserQuestionを使い、以下を確認する。

- 分析した変更内容の要約を提示し、認識が合っているか確認する
- 変更の目的・動機について補足があれば聞く
- コミットメッセージに含めたい情報があれば聞く

### 4. コミットメッセージを作成してコミットする

以下のフォーマットに従ってコミットメッセージを作成し、コミットを実行する。

#### コミットメッセージのフォーマット

```
<件名: 変更内容の要約（1行、50文字以内目安）>

<本文: 変更の背景・理由・詳細（必要な場合のみ）>

Co-Authored-By: Claude {model} <noreply@anthropic.com>
```

#### 件名のルール

- **日本語で記述する**（このリポジトリの慣習に従う）
- 体言止めまたは動詞の連用形で終える（例:「〜を追加」「〜に変更」「〜を修正」）
- 変更の「何を」「どうした」が一目でわかるようにする
- 接頭辞は付けない（Conventional Commitsのprefixは使わない）

#### 本文のルール

- 件名だけで変更が十分に伝わる場合は本文を省略してよい
- 本文を書く場合は、件名の後に1行空行を入れる
- **「なぜ」その変更をしたか**を中心に書く（「何を」は差分を見ればわかる）
- 箇条書きを活用してよい

#### 注意事項

- ステージングされていない変更はコミットしない
- ステージングされた変更がない場合はユーザーに報告して終了する
- 1つのコミットに1つの論理的変更をまとめる
